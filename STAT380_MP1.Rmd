---
title: "STAT380_MP1"
author:
- name: Isaac Swope
- name: Andrew Loisele
date: "February 22, 2026"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = TRUE)
```

## Front Matter
```{r, message = FALSE}
# Libraries
library(dplyr)
library(ggplot2)
library(readxl)
library(lubridate)
library(knitr)
library(patchwork)

# Functions
countNA <- function(col){
  return(sum(is.na(col)))
}

```

## Reading in Data Set
```{r}
games_url <- "https://raw.githubusercontent.com/Swopei/STAT380-MP1_repo/main/data/CODGames2_mp.xlsx"
games_tmp <- tempfile(fileext = ".xlsx")
download.file(games_url, destfile = games_tmp, mode = "wb")
Games <- read_excel(games_tmp)
```

This solution was found using Google Gemini, the prompt used was, "How can a .xlsx file be read into R from an url?"

Gemini generation the following as one possible solution: 

library(readxl)

\# 1. Define the URL
url <- "https://example.com/data.xlsx"

\# 2. Create a temporary file path
dest_file <- tempfile(fileext = ".xlsx")

\# 3. Download the file (CRITICAL: use mode = "wb")
download.file(url, destfile = dest_file, mode = "wb")

\# 4. Read the file
df <- read_excel(dest_file)

\# Optional: clean up the temp file
unlink(dest_file) 


## Data Exploration
This data set contains 27 columns and 211 rows.

### Variable 1 - FullPartial

The variable FullPartial is a categorical variable
```{r}
levels(as.factor(Games$FullPartial)) #gets categories
```

FullPartial has two categories: "Full" and "Partial"

```{r}
countNA(as.factor(Games$FullPartial)) #gets NA count
```

FullPartial has no NAs

```{r}
Games_FP <- Games %>%
  group_by(FullPartial) %>%
  summarize(
     count = sum(FullPartial == FullPartial),
     percent = paste0(round(sum(FullPartial == FullPartial)/nrow(Games)*100, 2), "%")
  )

kable(Games_FP)

ggplot(data = Games_FP,
        mapping = aes(x = "", y = count, fill = FullPartial)
        ) +
  geom_bar(stat = "identity", width = 1) +
  coord_polar("y", start = 0) +
  theme_void() +
    geom_text(aes(label = percent), position = position_stack(vjust = 0.5)) +
  labs(title = "Pie Chart of FullPartial", subtitle = "n = 211")
```

From the above table and pie chart, we can see that Full is much more likely to appear than Partial.

### Variable 2 - Eliminations

The variable Eliminations is quantitative
```{r}
countNA(Games$Eliminations) #gets NA count
```

Eliminations contains no NAs, so the summary statistics can be calculated directly

```{r}
Games_elim <-Games %>%
  summarize(
    total = sum(Eliminations),
    mean = mean(Eliminations),
    min = min(Eliminations),
    Q1 = quantile(Eliminations, .25),
    median = median(Eliminations),
    Q3 = quantile(Eliminations, .75),
    max = max(Eliminations)
   
    
  )

kable(Games_elim)

```

```{r, fig.height=4, fig.width=9}
elim_box <- ggplot(data = Games,
       mapping = aes(x = Eliminations)) +
  geom_boxplot() + 
  labs(title = "Eliminations Boxplot")

elim_hist <- ggplot(data = Games,
       mapping = aes(x = Eliminations)) +
  geom_histogram(fill = "black", color = "grey") +
  labs(title = "Eliminations Histogram")

elim_box + elim_hist
```

We can see that the eliminations variable has a positive, or right skew, with the mean and median being below the midpoint of the range of data. This lets us know that for most matches, this player is getting aroud 11 - 18 kills, with fewer matches getting in the high range of eliminations, with only two total matches above 30.

### Variable 3 - Choice

The variable Choice is a categorical Variable.

```{r}
levels(as.factor(Games$Choice)) #gets categories
```

Choice has 25 different categories, representing the 25 different maps that this player played on.

```{r}
countNA(as.factor(Games$Choice)) #gets NA count
```

Choice has one NA, which should be filtered.

```{r}
Games_choice <- Games %>%
  filter(!is.na(Choice)) %>%
  group_by(Choice) %>%
  summarize(
     count = sum(Choice == Choice),
     percent = paste0(round(sum(Choice == Choice)/nrow(Games)*100, 2), "%")
  ) %>%
  arrange(desc(count))

kable(Games_choice)

ggplot(data = Games_choice,
       mapping = aes(x = reorder(Choice, count), 
                     y = count)) + 
  geom_col() + 
  coord_flip() + 
  labs(x = "Choice", 
       y = "Count",
       title = "Counts of Maps Chosen")

```

We can see that out of the 25 different maps that were played on, most maps were played 5-10 times out of the 190 different games. Rush, Diesel, and Crossroads Strike were all played the most, 15 times each. Since this was the choice of what map to play, it either means that they came up the most when random maps were chosen to be a choice, or players prefer these maps and will choose them more often than the other map choice.

### Variable 4 - GameType

The variable GameType is a categorical Variable

```{r}
levels(as.factor(Games$GameType)) #gets categories
```

GameType has 4 different categories.

```{r}
countNA(as.factor(Games$GameType)) #gets NA count
```

GameType has no NAs

```{r}
Games_Type <- Games %>%
  group_by(GameType) %>%
  summarize(
     count = sum(GameType == GameType),
     percent = paste0(round(sum(GameType == GameType)/nrow(Games)*100, 2), "%")
  )

ggplot(data = Games_Type,
        mapping = aes(x = "", y = count, fill = GameType)
        ) +
  geom_bar(stat = "identity", width = 1) +
  coord_polar("y", start = 0) +
  theme_void() +
    geom_text(aes(x = 1.8, label = percent), position = position_stack(vjust = .5), size = 2.5)
```

From the pie chart, we can see that the most common game type by far is the team deathmatch (TDM) mode. The other three modes are far less likely, showing up only 7% of the time combined in all 211 matches.

### Variable 5 - Deaths

The variable Deaths is quantitative

```{r}
countNA(Games$Deaths) #gets NA count
```

Deaths has no NAs

```{r}
Games_Deaths <-Games %>%
  summarize(
    total = sum(Deaths),
    mean = mean(Deaths),
    min = min(Deaths),
    Q1 = quantile(Deaths, .25),
    median = median(Deaths),
    Q3 = quantile(Deaths, .75),
    max = max(Deaths),
    
  )

kable(Games_Deaths)
```

```{r, fig.hight=4, fig.width=9}
death_box <- ggplot(data = Games,
       mapping = aes(x = Deaths)) +
  geom_boxplot() + 
  labs(title = "Deaths Boxplot")

death_hist <- ggplot(data = Games,
       mapping = aes(x = Deaths)) +
  geom_histogram(fill = "black", color = "grey") +
  labs(title = "Deaths Histogram")

death_box + death_hist
```

The boxplot shows that the data for deaths is right skewed, meaning that there are more outliers in the data corresponding to games with a lot of deahts. It is more common to have games with fewer deaths, as there are no outliers in the lower values. 50% of the games had deaths between 12 and 17 times.


## Proposed List of Questions

### Question 1: Was this data collected from when the player first started playing the game, or from a specific period of when they played?

### Question 2: How was this player chosen, and was the data selected from every match or selected matches on each day?

### Question 3: What exactly does the variable "FullPartial" represent?


## Answering questions using the data

### Is the playerâ€™s performance, as quantified by the amount of experience points gained (TotalXP variable) changing over time?
```{r}
# Making the month from the Date variable
Games_months <- Games %>%
  mutate(Month = month(Date, label = TRUE, abbr = FALSE))

month_order = c("June", "July", "August")
Games_months$Month <- factor(Games_months$Month, levels = month_order)

ggplot(data = Games_months,
       mapping = aes(x = TotalXP,
                     y = Month,
                     fill = Month)) +
  geom_boxplot() + 
  coord_flip() +
  scale_fill_manual(values = c("gold", "orange", "tomato")) + 
  labs(title = "TotalXP Earned in Games by Month")

Games_permonth <- Games_months %>%
  group_by(Month) %>%
  summarize(
    Mean_TotalXP = mean(TotalXP),
    Median_TotalXP = median(TotalXP)
  )

kable(Games_permonth)

```

From the above box plots and table of average month TotalXP, it is apparent that this player's average performance does not seem to increase or decrease over these three months. While the player's median and mean performance as measured by TotalXP decreases from June to July, they rise to back to similar levels in August.


### Does the map have any effect on the amount of eliminations and deaths?



## Contributions

Reading in data - Isaac Swope

Variable Exploration - Split Work: Isaac and Andrew

List of Questions - Andrew Loisele

Player Performance by Month - Isaac Swope

Map Effect on Eliminations and Deaths - 

